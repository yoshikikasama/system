# CloudLicence

## 35.

- CloudFormation で作成する Windows ベースの EC2 を既存の AWS Managed Microsoft AD ディレクトリのドメインに参加させる方法：

  - CloudFormation template を使用してタグを伝番させ、AWS::SSM::Association リソースで AWS-JoinDirectoryServiceDomain オートメーションランブックを関連づけることで、EC2 インスタンスを AWS Managed Microsoft AD ドメインに効率的に参加させることができる。
  - AWS::SSM::Association リソースは、AWS Systems Manager の一部である State Manager を用いて、インスタンスに定期的に適用する設定やポリシーを管理します。このリソースを使用すると、SSM ドキュメント（ランブックやコマンドドキュメントなど）を特定のインスタンスやリソースグループに自動的に適用できます。
  - AWS-CreateManagedWindowsInstanceWithApproval: AWS Systems Manager (SSM) オートメーション ドキュメントの一つです。このドキュメントは、承認プロセスを経た後に管理対象の Windows インスタンスを作成するために使用されます。主にガバナンスやコンプライアンス要件を満たすために、インスタンスの作成前に必要な承認を確保する場合に便利です。

- Firewall: 不正なアクセスや通信をブロックするためのネットワークセキュリティ対策に利用されるもの。
- AWS WAF:

  - web application firewall。web アプリレベルでのトラフィック制御、HTTP/HTTPS トラフィックの監視と制御に重点を置いている、
  - CloudFront, ALB, API Gateway が保護リソースとなる。

- AWS Network Firewall:
  - 概要:
    - VPC 単位でパケットの制御が可能。
    - ステートレスパケットフィルタ(5-tuple): 行きと帰りの通信を双方向で許可する必要があるフィルタリング方式。
    - ステートフルパケットフィルタ(5-tuple): 行きの通信のみを定義するだけで帰りの通信は自動的に許可されるフィルタリング方式。
    - ドメインの制御: aaa.jp のようなドメイン制御(ホワイトリスト/ブラックリスト)ができるフィルタリング方式。ドメインの制御はステートフル。
    - Suricata 互換の IPS: シグネチャ型(パターンベース)の IPS が実装可能。
    - 5-tuple: 送信元、送信元ポート番号、宛先 IP、宛先ポート番号、プロトコル番号の 5 つを指定して制御ルールを記載すること。
  - 構成要素:
    -   ![Screenshot 2024-04-25 at 7 46 27](https://github.com/yoshikikasama/system/assets/61643054/4975e5aa-1415-4f9b-b253-b18e1abb6d7e)
    - ファイアウォール: AWS Network Firewall 構築時に指定したサブネットに Gateway Load Balancer のエンドポイントが作成されるため、検査対象の通信は一時的に VPC 外へ転送されることになる。
    - ファイアウォールポリシー:
