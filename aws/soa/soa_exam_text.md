# soa試験テキスト

## モニタリング、ロギング、修復
- ワークロード: AWS上に構築されたシステム。
- メトリクス: AWSリソースの使用状況を収集し、数値化された時系列データセットのこと。
- CloudWatch: メトリクスのリポジトリ。
- CloudWatchエージェント: アプリケーションごとのメモリ使用率など、OSの内部で取得する必要のあるデータをカスタムメトリクスとしてCloudWatchに収集する。
- CloudWatch Logs: ログの一元管理・検索・フィルター処理を行うサービス。
- AWS Config: AWSリソースの設置を記録して評価するサービス。
    - AWS Config ルール: AWSリソースの設定内容をチェックして、修復アクションの実行(AWS Systems Manager Automation)、SNSによる通知を行う。

## 信頼性とビジネス継続性

- 信頼性: 障害に対して回避・維持・回復する能力。

- Auto Scaling: ターゲットに対してスケーリングを行うことが目的。
    - 手動スケーリング
    - スケジュールスケーリング
    - 動的スケーリング:
        - 簡易スケーリング: CPU使用率が50%を超えるとEC2インスタンスを1つ追加するなど。実行できることも少ないため、非推奨。
        - ステップスケーリング: CPU使用率が60~70%ならEC2インスタンスを1つ追加、70~80%ならEC2インスタンスを2つ追加など。
        - ターゲット追跡スケーリング: CPU使用率50%が目標値とすると、スケーリンググループ全体のCPU使用率が50%になるように自動的にスケールアウト/スケールインの調整がされる。
    - 予測スケーリング: 過去のCloudWatchのメトリクスを機械学習させてシステム負荷の動向を推測し、そのパターンに応じてスケーリングを行う。
    - スケーリング対象:
        - Amazon EC2 Auto Scaling Group
        - Amazon EC2 スポットフリートリクエスト
        - Amazon ECS
        - Amazon DynamoDB
        - Amazon Aurora
    - Auto Scaling Group: スケーリングに関するインスタンスを管理する論理的なグループ。インスタンス数の最小・最大・希望の台などを指定できる。
    - 起動テンプレート: Auto Scaling Groupでスケールアウトが発生し、新たにインスタンスを作成するときの事前の設定。
- ELB: ターゲット(EC2、コンテナ、IPアドレス)のトラフィックを自動分散させる負荷分散サービス。単一リージョンのサービス。
    - ロードバランサー: 一意なFQDN(Fully Qualified Domain Name)を使って接続し、プロトコルとポートごとに各リスナーに振り分け。
    - リスナー: プロトコルとポート、ルールごとに振り分け。
    - ターゲットグループ: ターゲットとヘルスチェックを管理。
    - ヘルスチェック: ターゲットに対して設定したプロトコルでアクセスを行い正常にアクセスできるかをテストする操作。合格したインスタンスのみにリクエストがルーティングされる。
    - ALB: ターゲットへの通信はALB自身が行うため、ターゲットから見た接続元IPはALBになる。接続したユーザーのIPを確認したい場合は、X-Forwarded-For HTTPヘッダーに接続元IPが記録されているので、これをターゲット側で出力するようにする。また、ALB自身にセキュリティグループを設定し、ターゲットのセキュリティグループにALBのセキュリティグループを設定するとターゲットへの接続をALBのみに制限し、外部から直接接続できなくする。
- NLB: UDPを扱うシステムや静的IPでアクセスをしたい場合に最適。

- Route53のヘルスチェック: システムのエンドポイントに対するヘルスチェック。複数のリージョンにあるシステムに対して可能。

- RDS: スタンバイレプリカとリードレプリカがある。
- Aurora: リードレプリカのみ。
- SQSのスケーリング: SQSのqueue数などをlambdaでget metricsで取得し、cloudwatchにput metricsする。cloud watchアラームによってAuto ScalingでEC2インスタンスをスケールアウトできる。
- 可用性: システムが使用できる状態を維持できる能力。
- 耐障害性: 障害が起きていてもシステムを維持できる能力。

- EC2のマルチAZ化: Auto Scaling Groupでネットワーク設定で複数のAZを指定。
- ELBのマルチAZ化: ALBの場合は稼働させるAZを2つ以上選択することによりマルチAZ構成となる。
- RDSのマルチAZ化: マルチAZ設定を行うと別のAZにRDS スタンバイインスタンスが構築される。

- フォールトトレラント: コンポーネントの一部が故障してもシステムがパフォーマンスを落とすことなく動作し続ける能力。

- Route53のルーティングポリシー:
    - 