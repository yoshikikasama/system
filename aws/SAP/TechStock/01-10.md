# Techstock

- Amazon EC2 の Ephemeral Disk(Instance Store Volume):
  - 「インスタンスストア」という領域に存在する「インスタンスストアボリューム」のこと。
  - インスタンスを停止するとデータが消去される。
  - データ計算用、一時ディスクとしての使用。

## 01

- AWS Organizations: 複数の AWS アカウントを効率的に管理・統制するためのサービス。

  - 新しい AWS アカウントを作成しリソースを割り当てる
  - AWS アカウントをグループ化して整理
  - AWS アカウントまたはグループに統一されたポリシーを適用
  - すべての AWS アカウントに単一の支払い方法を利用することで請求を簡素化
  - OU(Organization Unit): 組織単位。組織内にある複数 AWS アカウントのグループ。
  - SCP(Service Control Policy): AWS アカウントまたはグループに統一されたポリシーを適用するための機能です。
    - 「SCP と IAM で明示的に許可され」なおかつ「いずれでも明示的に拒否されていない」場合に権限を有していると評価されます。
    - 「ざっくりとした」制限を SCP で実施し、細かい制御を IAM で実施する、というアプローチが適切かと思います。
  - 組織の証跡: OU を作成した場合に、その OU 内の全 AWS アカウントの全イベントを記録する証跡を作成できる。
  - 利用可能な機能セット:
    - 全ての機能: 一括請求機能も含む、高度なアカウント管理機能。
    - 一括請求機能: OU 内のアカウント管理を一元化する基本的な機能。
  - ![Screenshot 2022-11-23 at 9 33 50](https://user-images.githubusercontent.com/61643054/203450104-8b13678e-2e1a-4ec7-96ff-e481e872cebd.png)
  - ![Screenshot 2022-11-23 at 9 36 24](https://user-images.githubusercontent.com/61643054/203450125-6d282f87-1410-4c32-9d0c-98d34389fbc7.png)

- AWS Directory Service による AWS Management Console への SSO(Single Sign On):

  - AWS Cloud 内で IAM Role を Microsoft AD または Simple AD のユーザーやグループに割り当てることができる。
  - AD Connector を使用して既存のオンプレミス Microsoft Active Directory のユーザーやグループも割り当てられる。

- ヒューリスティック：

  - 常に正しいとは限らないが経験的にある程度正しい解を導けることが分かっている推論や仮定などを利用して、近似的あるいは暫定的な解を得る手法。
  - 答えの精度が保証されない代わりに、回復に至るまでの時間が少ない。

- AWS のストリーム処理サービス:
  - Amazon Kinesis Data Streams:　ストリームデータを収集するサービス
    - デフォルトの保持期間：24 時間、保持期間の延長：7 日間、長期保存：最大 1 年
  - Amazon Kinesis Firehose: ストリームデータを収集してデータストアに格納するサービス
  - Amazon Kinesis Data Analytics: ストリームデータに対して ETL 処理を行うサービス
  - Amazon Managed Streaming for Apache Kafka: オープンソースのストリーム処理のソフトウェアである Apache Kafka のマネージド・サービス。
- Amazon CloudWatch: AWS リソースの監視、分析、およびアラート設定のためのサービス。
- Hadoop: 巨大なデータをバッチ処理するための並列分散処理基盤
  - HDFS(Hadoop Distributed File System): 複数のサーバーにファイルを分割して保持することで巨大なファイルも扱える。
  - MapReduce: 分散処理フレームワーク
- Amazon Elastic MapReduce(EMR):

  - MapReduce: Google が開発した、大規模なデータを効率的に分散処理するためのフレームワーク。必要な計算内容を実装した Map 処理と Reduce 処理を用意して、分散処理してくれる。
  - Hadoop の場合は非構造化データ
  - 複雑な設定なしに分散アプリケーションを利用可能。
  - 分散処理に必要なリソースを簡単に調達/廃棄可能。
  - Master Node はひとつ。いわゆるマスターの役割を担う。
  - Core Node は 1 つ以上。いわゆるスレーブの役割を担う。
  - クラスタを消してもデータは消えない。
  - EMR は Hadoop クラスタの構築と運用を行ってくれます。マネジメントコンソールで Hadoop クラスタに利用する EC2 インスタンスのノード数とインスタンスタイプを指定すると、10 分ほどで Hadoop クラスタを構築してくれます。Hadoop クラスタで構成する EC2 インスタンスに異常があれば、異常のあったインスタンスは破棄して新規にインスタンスを起動してくれます。

- syslog: 稼働しているプログラムのログを、効率的に収集し記録する

## 02

- 目標復旧時間(Recovery Time Objective): いつまでに事業を復旧するかという目標時間を表す指標。
- 目標復旧時点(Recovery Point Objective): データ損失の最大許容量。24 時間であれば 24 時間分のデータ損失は許容される。

- AWS VPN(Virtual Private Network): オンプレミスネットワーク、リモートオフィス、クライアントデバイス、および AWS グローバルネットワーク間に安全な接続を確立します。AWS VPN は、AWS サイト間 VPN と AWS Client VPN で構成されています。

  - Site-to-Site VPN:VPC とリモートネットワーク間で、IPsec および VPN 接続を作成できます。Site-to-Site VPN 接続の AWS 側では、仮想プライベートゲートウェイまたはトランジットゲートウェイによって、自動フェイルオーバーのための 2 つの VPN エンドポイント (トンネル) が提供されます。Site-to-Site VPN 接続のリモート側でカスタマーゲートウェイデバイスを設定します。
    - 1 つの VPN 接続で 2 つの IPsec トンネル。
    - オンプレミス機器と VPN を安全な回線で繋ぐことができ、アクセス、管理を行うことができます。特に支社やデータセンターなどオンプレミス機器の設置場所から、クラウド環境への接続を作り出します。
    - お客様のデータセンターやオフィスを IPsec VPN を介して AWS へプライベートに接続するサービス。
    - オンプレ環境側にルーターを設置して IPsec VPN による暗号化を実現しています。価格の安さと接続の容易さから Direct Connect のバックアップ回線として利用される
  - AWS Client VPN:AWS リソースまたはオンプレミスネットワークに安全にアクセスできるようにする、クライアントベースのマネージド VPN サービスです。ユーザーが接続して安全な TLS VPN セッションを確立できるエンドポイントを設定します。そうすることにより、クライアントは OpenVPN ベースの VPN クライアントを使用して、どこからでも AWS またはオンプレミスのリソースにアクセスできるようになります。
    - お客様のクライアントを Open VPN ベースの VPN を介して AWS へプライベートに接続するサービス。
    - 名前の通りクライアント PC から Open VPN ベースの VPN 接続を可能にしています。Site-to-Site VPN はルータの準備が必要でしたが、こちらはツールをダウンロードするだけで接続できるため、安価に即日で接続が可能です。テレワークで自宅環境から会社の AWS 環境に接続したい場合などに利用できます。
  - [初心者向け AWS Client VPN 入門](https://qiita.com/Masayuki-Goto/items/6f7f2bc100a2945d1292)

- カスタマーゲートウェイ(CGW):インターネットルーティングが可能な固定の IP アドレスにリソース名を定義し、AWS へ登録
- カスタマーゲートウェイデバイス: オンプレミスネットワーク (Site-to-Site VPN 接続のユーザー側) で所有または管理している物理アプライアンスまたはソフトウェアアプライアンスです。
- 仮想プライベートゲートウェイ(VGW): VPC が Direct Connect or VPN と接続するために利用するゲートウェイ。オンプレミス環境に接続するときに AWS(VPC)側に取り付けるゲートウェイ。
- Internet Gateway:特に要件がなく、VPC とインターネットを出入りしたい
- NAT Gateway: IPv4 を使って VPC からインターネットに出るのみ
- Egress-only Internet Gateway:IPv6 を使って VPC からインターネットに出るのみ
- Transit Gateway: 複数の VPC と複数のオンプレミス環境同士の連結を束ねる中央ネットワークハブのような役割。

- VPC Peering:異なる VPC 間を接続する機能。CIDR の重複は許されない。
- AWS Direct Connect Location(VGW):AWS クラウドへの物理的な接続を提供する拠点のことです。

![Screenshot 2023-05-03 at 8 46 51](https://user-images.githubusercontent.com/61643054/235809426-341d7792-fb7b-4488-a0ae-1ef813ca703c.png)
![Screenshot 2023-05-03 at 8 48 14](https://user-images.githubusercontent.com/61643054/235809440-8752fefd-dd31-48f7-8c5f-1f5a3995d289.png)
![Screenshot 2023-05-03 at 8 48 20](https://user-images.githubusercontent.com/61643054/235809443-626502c0-6484-47c2-ab8e-27817f04db6c.png)
![Screenshot 2023-05-03 at 8 48 29](https://user-images.githubusercontent.com/61643054/235809448-734b7f13-dce3-4bfc-b78a-bf70738ae830.png)

- RDS のマルチ AZ DB クラスター構成:
  - <img width="812" alt="Screenshot 2022-12-04 at 9 17 48" src="https://user-images.githubusercontent.com/61643054/205467780-f1450cab-a074-4dc8-b764-88b08b435484.png">
- RDS のマルチ AZDB インスタンス構成と Aurora のマルチ AZ 構成:
  - <img width="805" alt="Screenshot 2022-12-30 at 12 48 17" src="https://user-images.githubusercontent.com/61643054/210032740-d4468371-cad3-4787-be5e-b86100d4a462.png">
- RDS ののマルチ AZDB インスタンス構成とマルチ AZ DB クラスター構成の比較:

  - <img width="907" alt="Screenshot 2022-12-30 at 12 59 53" src="https://user-images.githubusercontent.com/61643054/210033238-3a8e06d2-29b5-4778-ba58-2becbc20df07.png">

- Amazon CloudSearch: web site またはアプリケーション向けの検索ソリューションを容易かつコスト効率良く設定、管理、スケールできる。

## 03.

- S3 の署名付き URL:

  - 署名付き URL の有効期限が切れていないもの
  - 署名付き URL の作成者がそのオブジェクトへのアクセス許可を持っているもの

- Amazon EMR:

  - マスターノード:
    - クラスターを制御し、指示を与える。
    - マスターノードが終了するとクラスターも終了するため、突然終了しても問題が発生しないクラスターを実行している場合のみ、スポットインスタンスとして起動するようにする。
  - コアノード:
    - データを処理して、HDFS を使用してデータを格納する。
    - コアインスタンスを終了するとデータ損失のリスクがある。
  - タスクノード:
    - データを処理するが、HDFS に永続的にデータを保持しない。
  - [EMR のクラスター戦略](https://docs.aws.amazon.com/ja_jp/emr/latest/ManagementGuide/emr-plan-instances-guidelines.html#emr-plan-spot-scenarios)

- CloudFormation:

  - Retain: スタックが削除される際にリソースを保持するための記載。

- HA(High Availability) Solution: システムの可用性が高い。
- CNAME レコード:
  - DNS の一種で特定のドメインに対する別名を定義するために使用される。
  - 具体的には、あるドメイン名に対して、別のドメイン名をエイリアスとして関連付けることができます。
  - たとえば、example.com というドメイン名に対して、www.example.comという別名を関連付けることができます。
  - 複数のドメイン名に対して、同じ IP アドレスを共有する必要がある場合、CNAME レコードを使用することで管理が容易になります。
  - ウェブサイトの URL を変更した場合、CNAME レコードを使用して、新しい URL に古い URL を自動的にリダイレクトすることができます。
  - CNAME レコードは、ルートドメイン名 (ドメイン名の最上位レベル) には使用できません。たとえば、example.com のルートドメイン名には CNAME レコードを使用できません。
- Route53 での ALB の紐付け:
  - レコードセットを登録:
    - Name: ドメイン名（例: example.com）
    - Type: CNAME
    - TTL: レコードがキャッシュされる時間（秒数）
    - Value: ALB の DNS 名（例: loadbalancer-123456789.ap-northeast-1.elb.amazonaws.com）
  - これによって、ドメイン名「example.com」が ALB の DNS 名「loadbalancer-123456789.ap-northeast-1.elb.amazonaws.com」に関連付けられます。ユーザーが「example.com」にアクセスすると、DNS サーバーは CNAME レコードを参照して、ALB の DNS 名にリダイレクトします。その後、ALB によって負荷分散が行われ、バックエンドの Web サーバーにリクエストが転送されます。
- Route53 で Elastic IP アドレスを登録することで、そのアドレスを使用して直接 Web サーバーにアクセスすることができます。これにより、Web サーバーに対するトラフィックが ALB を介さずに直接行き来するため、ALB を導入しても負荷分散が実現できません。
- ALB を使用する場合、ALB の背後に Web サーバーを配置する必要があります。この場合、Route53 エイリアスレコードを使用して、ALB の DNS 名を指定することで、DNS レベルで負荷分散が実現されます。この場合、ユーザーのリクエストは ALB を通じて Web サーバーに転送されるため、負荷分散が適切に行われます。

- URL ホワイトリスト: 不正なアクセスを制限することにより、情報漏洩や不正な活動などのリスクを減らすことができます。
- プロキシ設定には、http_proxy と https_proxy の 2 つの環境変数を設定する必要があります。
  - http_proxy は、http プロトコルでの通信において、EC2 インスタンス A が使用するプロキシサーバーのアドレスを指定します。例えば、http://10.0.0.10:3128と指定することで、EC2インスタンスAがhttpプロトコルを使用した通信を行う際には、プロキシサーバーのアドレスが10.0.0.10で、ポート番号が3128であることが指定されます。
  - 同様に、https_proxy は、https プロトコルでの通信において、EC2 インスタンス A が使用するプロキシサーバーのアドレスを指定します。例えば、https://10.0.0.10:3128と指定することで、EC2インスタンスAがhttpsプロトコルを使用した通信を行う際には、プロキシサーバーのアドレスが10.0.0.10で、ポート番号が3128であることが指定されます。
  - これらの環境変数を設定することで、EC2 インスタンス A はプロキシサーバーを経由して特定のドメインへのアウトバウンド接続を行うことができます。ただし、この設定は EC2 インスタンス A のプロキシ設定のみに影響を与えるため、EC2 インスタンス B 以外からのトラフィックをブロックするためのセキュリティグループの設定も必要です。
  - NAT: パブリックサブネットに配置されており、プライベートサブネットとインターネットの間でトラフィックをルーティングするために使用されます。

## 04.
