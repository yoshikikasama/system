![Screenshot 2023-07-25 at 6 31 14](https://github.com/yoshikikasama/network-and-server/assets/61643054/19dbfeaf-307a-45e4-b326-8695d500d198)
![Screenshot 2023-07-25 at 6 31 08](https://github.com/yoshikikasama/network-and-server/assets/61643054/7fc5cd43-5235-4f85-b45f-90db63953585)
![Screenshot 2023-07-25 at 6 31 00](https://github.com/yoshikikasama/network-and-server/assets/61643054/3a61bc53-6a2b-4998-aba7-4d51d4ca9128)
![Screenshot 2023-07-25 at 6 30 52](https://github.com/yoshikikasama/network-and-server/assets/61643054/8fc11a7a-27cd-4aa0-a2b7-59138fd7894a)

# Techstock

## 61.

- ![Screenshot 2023-07-23 at 21 39 55](https://github.com/yoshikikasama/network-and-server/assets/61643054/af0343fd-1424-4cee-a0ef-737727950bae)

- Amazon ECS のスポットインスタンス自動ドレイン:

  - 2 分間の中断の通知を受信すると、スポットインスタンスが自動的に "ドレイン" 状態に設定されます。スポットインスタンスで実行している ECS タスクは、インスタンスが削除される前に自動的にシャットダウンがトリガーされ、代替タスクがクラスターの別の場所にスケジュールされます。削除プロセスに入った後のインスタンスで、新しい ECS サービスタスクが開始されることはありません。ECS では、インスタンスに備わっている "ドレイン" 機能を使用して、基盤となる EC2 インスタンスの削除に伴うタスク終了の調整を引き継ぎます。削除の管理、代替タスクのスケジュール設定、LB 接続の正常な終了によって、サービスの中断が発生しにくくなります。お客様にとっては、ECS クラスターの一部としてスポットインスタンスを使用することが容易になります。
  - 利用可能なキャパシティーがなくなった場合、または、スポット料金がお客様のリクエストの上限料金を超えた場合には、Amazon EC2 はスポットインスタンスを終了、停止、または休止状態にします。Amazon EC2 は、終了アクションおよび停止アクションに対して、スポットインスタンスに 2 分間の中断通知を提供します。休止状態のアクションについては、2 分間の通知は提供されません。インスタンスで Amazon ECS スポットインスタンスのドレインが有効になっている場合、ECS はスポットインスタンスの中断通知を受け取り、インスタンスを DRAINING ステータスにします。
  - コンテナインスタンスを DRAINING に設定すると、Amazon ECS によって新規タスクがそのコンテナインスタンスに配置されなくなります。ドレインしているコンテナインスタンス上にある PENDING 状態のサービスタスクは即時停止されます。クラスター内に使用可能なコンテナインスタンスがある場合、そのインスタンスで代わりのサービスタスクが開始されます。

- DRAINING:

  - VM がインスタンス グループから削除されたときや、エンドポイントがゾーンネットワークエンドポイントグループ（NEG）から削除されたときに、既存の進行中リクエストを完了するための時間を確保するプロセスです。
  - コンテナインスタンスを DRAINING に設定すると、Amazon ECS によって新規タスクがそのコンテナインスタンスに配置されなくなります。

- Blue-Green Deployment 戦略の使用:

  - 個別のスタックを効率的に使用して、更新されたアプリケーションを本稼働にデプロイする一般的な方法の 1 つです。
  - Blue 環境は、現在のアプリケーションをホストする本稼働スタックです。
  - Green 環境は、更新されたアプリケーションをホストするステージングスタックです。

- Amazon S3 Transfer Acceleration: CloudFront のエッジロケーションを使用してグローバルユーザーに低レイテンシーアクセスを提供するのに役立つ。

## 62.

- ストアドプロシージャ: 一連の SQL クエリと論理操作を実行するためにユーザーが作成するオブジェクトです。プロシージャはデータベースに保存され、実行するのに十分な権限を持つユーザーが利用できます。
  - ストアードプロシージャーは SELECT 照会に加えてデータ定義言語 (DDL) およびデータ操作言語 (DML) を組み込むことができます。ストアドプロシージャは値を返す必要はありません。ループや条件式を含む PL/pgSQL 手続き型言語を使用して論理フローを制御できます。
  - ストアドプロシージャは通常、データ変換、データ検証、およびビジネス固有の操作のためのロジックをカプセル化するために使用されます。複数の SQL ステップをストアドプロシージャに結合することで、アプリケーションとデータベース間のラウンドトリップを減らすことができます。
- リフトアンドシフト（Lift and Shift）: 「まずはクラウド上にそのまま既存システムをあげて（Lift）、その後に随時変更していく（Shift）」という意味

- AWS App Sync:

  - シンプルな GraphQL ベースの実装
  - オフライン処理やデータ競合の解決をサポートする豊富なチャット向け機能
  - Dynamo DB, AWS Lambda, Elastic Search などから柔軟に構成できる。

- Retain policy: CloudFormation のスタックを Delete してもデータを残す方法

## 63.

- Amazon Managed Streaming for Apache Kafka(Amazon MSK):

  - オープンソースで安全性の高い Apache Kafka クラスターを複数のアベイラビリティーゾーン (AZ) に分散して提供し、耐障害性と可用性の高いストリーミングストレージを実現します。Amazon MSK は、高度に設定可能、観察可能、かつスケーラブルで、さまざまなユースケースに必要な柔軟性と制御を可能にします。

- アクティブ/パッシブ (フェイルオーバー):

  - プライマリリソースまたはリソースグループをほとんどの時間で利用可能にして、すべてのプライマリリソースが使用できなくなった場合に備えて、セカンダリリソースまたはリソースグループをスタンバイ状態にする場合は、フェイルオーバー (アクティブ/パッシブ) 設定を使用します。クエリへの応答で Route 53 が返すのは、正常なプライマリリソースのみです。すべてのプライマリリソースで異常が発生した場合、Route 53 は、DNS クエリへの応答として正常なセカンダリリソースのみを返します。

- RPO, RTO の要件の明確化:
  - ![Screenshot 2023-07-25 at 6 30 36](https://github.com/yoshikikasama/network-and-server/assets/61643054/57217a87-6515-45c1-b412-eaedc9fa94af)
  - ![Screenshot 2023-07-25 at 6 30 43](https://github.com/yoshikikasama/network-and-server/assets/61643054/b94fcc95-caa2-44a4-b5ab-f0866b1a2e68)
  - ![Screenshot 2023-07-25 at 6 30 52](https://github.com/yoshikikasama/network-and-server/assets/61643054/405c53d4-d867-40a2-b774-5d49be99ad02)
  - ![Screenshot 2023-07-25 at 6 31 00](https://github.com/yoshikikasama/network-and-server/assets/61643054/d46609ac-2363-46e1-88cb-c781e1c389c1)
  - ![Screenshot 2023-07-25 at 6 31 08](https://github.com/yoshikikasama/network-and-server/assets/61643054/36bcdd75-f4e9-44ab-8959-d11541c68d75)
  - ![Screenshot 2023-07-25 at 6 31 14](https://github.com/yoshikikasama/network-and-server/assets/61643054/264338b2-b751-4e1e-a92a-d12d37d8ed74)

## 64.

- Amazon MQ / Amazon SQS はどちらもメッセージキューイングサービスですが、それぞれの違いとどんな時にどちらを使用すべきか？:
  - Amazon MQ: 既存サービスで MQ を使っており、そこから AWS へ乗せ替えたい場合
    - ActiveMQ/RabbitMQ いずれかのブローカーを選択してインスタンスを立ち上げる。
    - そのため、キューを使っていない時間帯でもずっとインスタンス料金が課金される。
    - 使用状況によってはスケーリングの考慮やマルチ AZ による冗長化も必要。
  - Amazon SQS: 上記以外の場合(新規立ち上げなど)
    - フルマネージドのメッセージキューサービス。
    - Amazon MQ と異なり、スケーリングの考慮や冗長化を考慮する必要が無くなる。
    - また、従量課金による請求なので使用した分だけの料金になる。(インスタンス料金みたいなのは無い)
- Amazon API Gateway の @connections コマンド:

  - バックエンドサービスは次の WebSocket 接続 HTTP リクエストを使用して、接続されたクライアントへのコールバックメッセージの送信、接続情報の取得、またはクライアントの切断を行うことができます。

- AWS Direct Connect 接続で AWS VPN を確立する方法:
  - Direct Connect 接続で VPC への AWS VPC 接続を確立すると、インターネット経由の VPC よりも速くて安全な場合が多いです。Direct Connect 接続の AWS VPN 接続では、一貫性のあるスループットレベルを確保し、データを保護する暗号化アルゴリズムを実現します。
    - Direct Connect 接続を作成します。
    - Direct Connect 接続用のパブリック仮想インターフェイスを作成します。[Prefixes you want to advertise] (アドバタイズするプレフィックス) で、カスタマーゲートウェイデバイスのパブリック IP アドレスを入力し、必要に応じて、アドバタイズするネットワークプレフィックスを追加します。
    - 注意: 各 AWS リージョン (AWS 中国リージョンは除く) のすべての AWS パブリック IP アドレスのプレフィックスがパブリック仮想インターフェイスに送信されます。これには、AWS マネージドの VPN エンドポイントのパブリック IP アドレスが含まれます。
    - 新しい VPN 接続を作成します。以前のステップで使用したのと同じカスタマーゲートウェイのパブリック IP アドレスを使用してください。
    - 注: カスタマーゲートウェイは、ボーダーゲートウェイプロトコル (BGP) と自律システム番号 (ASN) を使用して設定できます。
    - VPC に接続するように VPN を設定します。

## 65.

- AWS Global Accelerator:

  - 世界中の顧客に提供するアプリケーションの可用性とパフォーマンスを改善するネットワーキングサービスです。
  - AWS Global Accelerator が提供する静的 IP アドレスを、Network Load Balancer、Application Load Balancer、EC2 インスタンス、Elastic IP アドレスなどのリージョン別 AWS リソースまたはエンドポイントに関連付ける。IP アドレスは AWS エッジロケーションからのエニーキャストであるため、ユーザーに近い AWS グローバルネットワークへのオンボーディングを提供します。
  - ゲーム (UDP)、IoT (MQTT)、Voice over IP などの HTTP 以外のユースケース、および静的 IP アドレスまたは確定的な高速地域フェールオーバーを特に必要とする HTTP ユースケースに最適です。
  - 2 つのグローバルな静的 public ip が提供され、アプリケーションへの固定されたエントリポイントとして機能するため、可用性が向上する。
  - Global Accelerator では、2 つのグローバルな静的パブリック IP が提供され、アプリケーションへの固定されたエントリポイントとして機能するため、可用性が向上します。ユーザーは変更を加えることなく、バックエンドで Application Load Balancer、Network Load Balancer、EC2 インスタンス、Elastic IP などの AWS アプリケーションエンドポイントを追加または削除します。
  - エンドポイントの障害による影響を軽減するため、Global Accelerator はトラフィックを最も近い、正常で利用可能なエンドポイントに自動的に再ルーティングします。アプリケーションアーキテクチャが大きくなると複雑となるため、ユーザー向けの IP リストが長くなり、トラフィックルーティングロジックがあいまいになります。
  - AWS Global Accelerator は、グローバルに分散されたエッジロケーションからエニーキャストされる 2 つの静的 IP を提供することでこれを解決し、デプロイされている AWS リージョンの数に関係なく、アプリケーションへの単一のエントリポイントを提供します。このため、アプリケーションの可用性を低下させることなく、オリジン、利用可能なゾーン、リージョンを追加または削除できます。トラフィックルーティングは手動で管理するか、あるいはエンドポイントのトラフィックダイヤルと重みを使用してコンソールで管理します。アプリケーションエンドポイントに障害または可用性の問題がある場合、AWS Global Accelerator が新しい接続を正常なエンドポイントに自動的に数秒以内でリダイレクトします。
  - ![Screenshot 2023-07-26 at 7 29 29](https://github.com/yoshikikasama/network-and-server/assets/61643054/be527141-3e9f-4983-b910-5ac02af602aa)

- Application Load Balancer のリスナー:

  - Application Load Balancer の使用を開始する前に、1 つまたは複数のリスナーを追加する必要があります。リスナーとは、設定したプロトコルとポートを使用して接続リクエストをチェックするプロセスです。リスナーに対して定義したルールにより、ロードバランサーが登録済みターゲットにリクエストをルーティングする方法が決まります。

- ある会社が 10 個の新しいドメイン名を登録しました。これらのドメインは、ビジネスにおけるインターネットマーケティングのために使用されます。同社は、ウェブ訪問者をドメイン固有の URL に送信するソリューションが必要です。JSON ドキュメントが、すべてのドメインとターゲット URL を定義します。Amazon Route 53 は、すべての DNS レコードを管理します。ソリューションアーキテクトは、HTTP と HTTPS クエリを受け取るリダイレクトサービス

  - ![Screenshot 2023-07-26 at 7 58 20](https://github.com/yoshikikasama/network-and-server/assets/61643054/c4281173-83d4-4bd2-a265-9e19978d8e55)

- AWS Network Firewall:

  - ネットワークトラフィックをきめ細かく制御するファイアウォールルールを定義できます。Network Firewall は AWS Firewall Manager と連携するため、Network Firewall ルールに基づいてポリシーを構築し、それらのポリシーを仮想プライベートクラウド (VPC) とアカウント全体に一元的に適用できます。
  - カスタマイズされたルールを実装して、VPC が未承認のドメインにアクセスすることを防止したり、数千の既知の不正な IP アドレスをブロックしたり、シグネチャベースの検出を使用して悪意のあるアクティビティを特定したりできます。AWS Network Firewall は、CloudWatch メトリクスを介してファイアウォールのアクティビティをリアルタイムで可視化し、ログを S3、CloudWatch、Kinesis Firehose に送信することでネットワーク トラフィックの可視性を高めます。
  - AWS Network Firewall を使用して制御された制御されたアウトバウンドトラフィック用に別の VPC を使用してトラフィックを統合することが可能。
  - ![Screenshot 2023-07-26 at 8 45 01](https://github.com/yoshikikasama/network-and-server/assets/61643054/ea5fa8df-a158-4317-a149-1a423f2651d6)
  - ![Screenshot 2023-07-26 at 8 45 33](https://github.com/yoshikikasama/network-and-server/assets/61643054/693f680e-f5d2-48b8-8edf-3c64e897b021)

- 単一の Amazon CloudFront ウェブディストリビューションを使用して、複数のビヘイビアを使い、複数のオリジンのコンテンツを配信する:
  - 例えば、ウェブサイトが Amazon Simple Storage Service (Amazon S3) バケットからの静的コンテンツとロードバランサーからの動的コンテンツを提供する場合があります。単一の CloudFront ウェブディストリビューションから両方のタイプのコンテンツを提供できます。
    - 次の手順に従い、CloudFront ウェブディストリビューションを設定して、S3 バケットの静的コンテンツとロードバランサーの動的コンテンツを提供します。
    - CloudFront コンソールからウェブディストリビューションを開きます。
    - Origins (オリジン) タブを選択します。
    - S3 バケット用にオリジン 1 つとロードバランサー用に別なオリジンを作ります。
      - 注: カスタムオリジンサーバーまたは S3 ウェブサイトエンドポイントを使う場合、オリジンドメイン名 フィールドにオリジンのドメイン名を入力します。
    - ディストリビューションから ビヘイビア タブを選択します。
    - パスパターンを指定するビヘイビアを作成して、すべての静的コンテンツリクエストを S3 バケットにルーティングします。たとえば、「images/\*.jpg」パスパターンを設定して、画像 ディレクトリにある「.jpg」ファイルのすべてのリクエストを S3 バケットにルーティングします。
    - ディフォルト (\*) パスパターンビヘイビアをを編集して、ロードバランサーとしてオリジンを設定します。

## 66.

- AWS Control Tower: 規範的なベストプラクティスに従って、AWS 複数アカウント環境を設定して管理するための簡単な方法を提供します。

- SCP を許可リストと使用する:
  - AWS 管理の FullAWSAccess SCP を、許可したいサービスやアクションのみを明示的に許可する SCP で置き換える必要があります。デフォルトの FullAWSAccess SCP を削除することで、すべてのサービスのすべてのアクションが暗黙的に拒否されるようになります。そうするとカスタム SCP は、許可したいアクションのみについて、暗示的 Deny を明示的 Allow で上書きします。指定されたアカウントに対してアクセス許可を有効にするには、ルートからアカウントへの直接パス内の各 OU のすべての SCP が (アカウント自体にアタッチされていても)、そのアクセス許可を許可する必要があります。

## 67.

- AWS DataSync:

  - オンプレミスストレージ、エッジロケーション、または他のクラウドと、AWS ストレージサービスの間で、および AWS ストレージサービス間で、大規模なデータのコピーを簡素化、自動化、および高速化します。DataSync は、Network File System (NFS) 共有、Server Message Block (SMB) 共有、File system distribuito Hadoop (HDFS)、セルフマネージドオブジェクトストレージ、Google Cloud Storage、Azure Files、AWS Snowcone、Snow 上の Amazon S3 互換ストレージ、Amazon Simple Storage Service (Amazon S3)、Amazon Elastic File System (Amazon EFS) ファイルシステム、Amazon FSx for Windows File Server ファイルシステム、Amazon FSx for Lustre ファイルシステム、Amazon FSx for OpenZFS ファイルシステム、および Amazon FSx for NetApp ONTAP ファイルシステムとの間でデータをコピーできます。

- AWS のマイグレーション関連ツールおよびサービス:
  - ![Screenshot 2023-07-27 at 7 57 11](https://github.com/yoshikikasama/network-and-server/assets/61643054/47b689f7-3ed1-47d2-883c-becfa8a3a298)

