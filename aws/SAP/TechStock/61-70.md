# Techstock

## 61.

- ![Screenshot 2023-07-23 at 21 39 55](https://github.com/yoshikikasama/network-and-server/assets/61643054/af0343fd-1424-4cee-a0ef-737727950bae)

- Amazon ECS のスポットインスタンス自動ドレイン:

  - 2 分間の中断の通知を受信すると、スポットインスタンスが自動的に "ドレイン" 状態に設定されます。スポットインスタンスで実行している ECS タスクは、インスタンスが削除される前に自動的にシャットダウンがトリガーされ、代替タスクがクラスターの別の場所にスケジュールされます。削除プロセスに入った後のインスタンスで、新しい ECS サービスタスクが開始されることはありません。ECS では、インスタンスに備わっている "ドレイン" 機能を使用して、基盤となる EC2 インスタンスの削除に伴うタスク終了の調整を引き継ぎます。削除の管理、代替タスクのスケジュール設定、LB 接続の正常な終了によって、サービスの中断が発生しにくくなります。お客様にとっては、ECS クラスターの一部としてスポットインスタンスを使用することが容易になります。
  - 利用可能なキャパシティーがなくなった場合、または、スポット料金がお客様のリクエストの上限料金を超えた場合には、Amazon EC2 はスポットインスタンスを終了、停止、または休止状態にします。Amazon EC2 は、終了アクションおよび停止アクションに対して、スポットインスタンスに 2 分間の中断通知を提供します。休止状態のアクションについては、2 分間の通知は提供されません。インスタンスで Amazon ECS スポットインスタンスのドレインが有効になっている場合、ECS はスポットインスタンスの中断通知を受け取り、インスタンスを DRAINING ステータスにします。
  - コンテナインスタンスを DRAINING に設定すると、Amazon ECS によって新規タスクがそのコンテナインスタンスに配置されなくなります。ドレインしているコンテナインスタンス上にある PENDING 状態のサービスタスクは即時停止されます。クラスター内に使用可能なコンテナインスタンスがある場合、そのインスタンスで代わりのサービスタスクが開始されます。

- DRAINING:

  - VM がインスタンス グループから削除されたときや、エンドポイントがゾーンネットワークエンドポイントグループ（NEG）から削除されたときに、既存の進行中リクエストを完了するための時間を確保するプロセスです。
  - コンテナインスタンスを DRAINING に設定すると、Amazon ECS によって新規タスクがそのコンテナインスタンスに配置されなくなります。

- Blue-Green Deployment 戦略の使用:

  - 個別のスタックを効率的に使用して、更新されたアプリケーションを本稼働にデプロイする一般的な方法の 1 つです。
  - Blue 環境は、現在のアプリケーションをホストする本稼働スタックです。
  - Green 環境は、更新されたアプリケーションをホストするステージングスタックです。

- Amazon S3 Transfer Acceleration: CloudFront のエッジロケーションを使用してグローバルユーザーに低レイテンシーアクセスを提供するのに役立つ。

## 62.

- ストアドプロシージャ: 一連の SQL クエリと論理操作を実行するためにユーザーが作成するオブジェクトです。プロシージャはデータベースに保存され、実行するのに十分な権限を持つユーザーが利用できます。
  - ストアードプロシージャーは SELECT 照会に加えてデータ定義言語 (DDL) およびデータ操作言語 (DML) を組み込むことができます。ストアドプロシージャは値を返す必要はありません。ループや条件式を含む PL/pgSQL 手続き型言語を使用して論理フローを制御できます。
  - ストアドプロシージャは通常、データ変換、データ検証、およびビジネス固有の操作のためのロジックをカプセル化するために使用されます。複数の SQL ステップをストアドプロシージャに結合することで、アプリケーションとデータベース間のラウンドトリップを減らすことができます。
- リフトアンドシフト（Lift and Shift）: 「まずはクラウド上にそのまま既存システムをあげて（Lift）、その後に随時変更していく（Shift）」という意味

- AWS App Sync:

  - シンプルな GraphQL ベースの実装
  - オフライン処理やデータ競合の解決をサポートする豊富なチャット向け機能
  - Dynamo DB, AWS Lambda, Elastic Search などから柔軟に構成できる。

- Retain policy: CloudFormation のスタックを Delete してもデータを残す方法

## 63.

- Amazon Managed Streaming for Apache Kafka(Amazon MSK):

  - オープンソースで安全性の高い Apache Kafka クラスターを複数のアベイラビリティーゾーン (AZ) に分散して提供し、耐障害性と可用性の高いストリーミングストレージを実現します。Amazon MSK は、高度に設定可能、観察可能、かつスケーラブルで、さまざまなユースケースに必要な柔軟性と制御を可能にします。

- アクティブ/パッシブ (フェイルオーバー):

  - プライマリリソースまたはリソースグループをほとんどの時間で利用可能にして、すべてのプライマリリソースが使用できなくなった場合に備えて、セカンダリリソースまたはリソースグループをスタンバイ状態にする場合は、フェイルオーバー (アクティブ/パッシブ) 設定を使用します。クエリへの応答で Route 53 が返すのは、正常なプライマリリソースのみです。すべてのプライマリリソースで異常が発生した場合、Route 53 は、DNS クエリへの応答として正常なセカンダリリソースのみを返します。

- RPO, RTO の要件の明確化:
  - ![Screenshot 2023-07-25 at 6 26 38](https://github.com/yoshikikasama/network-and-server/assets/61643054/c8f1d007-a65c-4ac1-80fc-67336e4b73ab)

