# Techstock

## 52.

- Amazon Redshift のワークロード管理(WLM): 複数のビジネスワークロードを分離すると共に、システム上で実行される様々なタイプの同時実行クエリ − の優先順位を設定することができます。

  - インタラクティブ：
    - 実行する人間の入力を受け付けるソフトウェア。インタラクティブなソフトウェアには、BI ツールやレポーティングアプリケーションなどのポピュラーなプログラムが含まれます。
    - 短時間のみ実行される、読み取り専用のユーザークエリー。低レイテンシーで実行する要件を含む Tableau ダッシュボードクエリーなどが該当します。
    - 長時間実行される、読み取り専用のユーザークエリー。過去 10 年間の営業データの集計する複雑な構造化レポートなどが該当します。
  - バッチ：
    - 手動介入を伴わない、サーバープログラム内の一連のジョブの実行（非インタラクティブ）。単一の入力ではなく、複数の入力の集合（”バッチ的な”入力とも言えます）に基づく一連のプログラムの実行は、カスタムジョブと呼ばれます。
    - 一括で実行される INSERT、UPDATE、および DELETE トランザクションもバッチクエリーに含まれます。ETL や ELT プログラムはこの一例です。
  - WLM の構成はパラメーターグループに含まれ、いくつのクエリーキューが処理に利用可能か、およびそれぞれのキューがどのようにそれらのキューにルーティングされるかを決定します。カスタムパラメーターグループを作成してグループ内の設定を編集し、それをクラスターに関連付けて下さい。以下のような設定が構成可能です。
    - それぞれのキュー内でいくつのクエリーが同時に実行可能か
    - キュー間でのメモリ配分
    - クエリーがどのようにキューにルーティングされるか。誰がクエリーを実行しているか、クエリーレベルは、などの基準
    - あるキューにおけるクエリータイムアウト設定

- Amazon API Gateway:

  - エッジ最適化エンドポイント: 地理的に分散されたクライアントに最適。最寄りの CloudFront POP (Point Of Presence) にルーティングされます。これは、API Gateway REST API のデフォルトのエンドポイントタイプです。CloudFront のエッジローケーションを経由して、最適なリージョンにルーティングされます。エッジロケーションからリージョンまでは AWS 内のネットワークが利用されるので高速です。
  - リージョンエンドポイント: 直接リージョンにルーティングされます。同一リージョンの場合、エッジロケーションを経由しない分、レイテンシを削減できます。デフォルトのエンドポイントタイプです。
  - プライベートエンドポイント: VPC 内から AWS PrivateLink でのみアクセスできるエンドポイントです。

- Amazon Kinesis Data Streams におけるシャード:

  - 基本的なスケーリング単位です。
  - 一つのシャードは、毎秒 1MB のデータ読み取り容量（最大 2,000 レコード/秒）と、毎秒 1MB のデータ書き込み容量（最大 1,000 レコード/秒）を提供します。
  - つまり、Kinesis Data Streams のパフォーマンス（データ入出力能力）は、シャードの数に直接的に関連します。
  - データはパーティションキーを基にシャードに分散され、一つのシャードには一つのパーティションキーが対応します。
  - このシャードの数を増やすと、データをより高速に書き込んだり読み取ったりすることができますが、コストも増加します。したがって、シャードの数を適切に管理することは、パフォーマンスとコストをバランス良く管理するために重要です。

- NLB: UDP トラフィックをサポート。
- ネットワーク ACL: 特定プロトコル以外のすべてのトラフィックを deny する機能を提供する。

- ![Screenshot 2022-11-21 at 8 01 15](https://user-images.githubusercontent.com/61643054/202931330-e8ef58b8-720d-40e7-bac7-f3bd5ed3c003.png)
- 基本的には AWS Shield Standard/AWS Shied Advanced/AWS WAF の３対策
  - AWS Shield Standard：Route 53 または CloudFront で使用する。無料。L3/L4 の防御。managed 分散サービス妨害(DDoS)に対する保護サービス。
  - AWS Shield Advanced：Route 53、CloudFront、ELB、EC2、AWS Global Accelerator で使用する。有料。L7、ネットワーク ACL を使った防御。
  - AWS WAF：CloudFront、ALB、APIGateway で使用。有料。IP アドレス、HTTP、クエリ文字列でのアクセス制限に加え、SQL インジェクション、クロスサイトスクリプティングにも有効。
- Amazon Intrusion Detection System(IDS): 侵入検知システム。悪意のあるアクティビティ、ポリシー違反、またはシステムの侵入または侵害を試みるユーザーからのネットワーク & システム攻撃を検出したときにアラートを送信します。
- Amazon Intrusion Prevention System(IPS): ネットワークトラフィックを監視および分析し、悪意のあるパターンや潜在的に有害なパケットを検出し、脆弱性の悪用を防止するアプライアンスです。SQL インジェクション、クロスサイトスクリプティング（XSS）、DDoS 攻撃への対応としては WAF による対応が優先されます。

## 53.

- CodePippeline:

  - コードの変更が毎回自動的に構築、テストされ、本番環境へのリリースのために準備されるリリースサービス。
  - AWS CloudFormation テンプレートへの変更を自動的に構築して、テストしてから本番環境スタックに構築させることができる。

- カナリア デプロイ: すでにデプロイされているバージョンと新しいバージョンの間でトラフィックを分割し、ユーザーのサブセットに展開して完全にロールアウトするアプリケーションの段階的なロールアウトです。
- Lambda の Version と Alias:
  - AWS Lambda では Publish すると固有の Version 番号が割り当てられる。
  - Version には任意の名前の Alias をつけることが可能で、Alias に関連付ける Version を変更することで、Alias を指定して Function を呼び出しているユーザが利用する Version を変更することができる。
  - Alias には Additional version というオプションが存在し、主として指定した Version とは異なる Version とその呼び出し割合を指定することができる。
  - Additional version の有無や呼び出し割合は任意のタイミングで変更ができ、新しい Version の呼び出し割合を徐々に増やしていくカナリアリリースが可能である。
