# Techstock

## 52.

- Amazon Redshift のワークロード管理(WLM): 複数のビジネスワークロードを分離すると共に、システム上で実行される様々なタイプの同時実行クエリの優先順位を設定することができます。

  - インタラクティブ：
    - 実行する人間の入力を受け付けるソフトウェア。インタラクティブなソフトウェアには、BI ツールやレポーティングアプリケーションなどのポピュラーなプログラムが含まれます。
    - 短時間のみ実行される、読み取り専用のユーザークエリー。低レイテンシーで実行する要件を含む Tableau ダッシュボードクエリーなどが該当します。
    - 長時間実行される、読み取り専用のユーザークエリー。過去 10 年間の営業データの集計する複雑な構造化レポートなどが該当します。
  - バッチ：
    - 手動介入を伴わない、サーバープログラム内の一連のジョブの実行（非インタラクティブ）。単一の入力ではなく、複数の入力の集合（”バッチ的な”入力とも言えます）に基づく一連のプログラムの実行は、カスタムジョブと呼ばれます。
    - 一括で実行される INSERT、UPDATE、および DELETE トランザクションもバッチクエリーに含まれます。ETL や ELT プログラムはこの一例です。
  - WLM の構成はパラメーターグループに含まれ、いくつのクエリーキューが処理に利用可能か、およびそれぞれのキューがどのようにそれらのキューにルーティングされるかを決定します。カスタムパラメーターグループを作成してグループ内の設定を編集し、それをクラスターに関連付けて下さい。以下のような設定が構成可能です。
    - それぞれのキュー内でいくつのクエリーが同時に実行可能か
    - キュー間でのメモリ配分
    - クエリーがどのようにキューにルーティングされるか。誰がクエリーを実行しているか、クエリーレベルは、などの基準
    - あるキューにおけるクエリータイムアウト設定

- Amazon API Gateway:

  - エッジ最適化エンドポイント: 地理的に分散されたクライアントに最適。最寄りの CloudFront POP (Point Of Presence) にルーティングされます。これは、API Gateway REST API のデフォルトのエンドポイントタイプです。CloudFront のエッジローケーションを経由して、最適なリージョンにルーティングされます。エッジロケーションからリージョンまでは AWS 内のネットワークが利用されるので高速です。
  - リージョンエンドポイント: 直接リージョンにルーティングされます。同一リージョンの場合、エッジロケーションを経由しない分、レイテンシを削減できます。デフォルトのエンドポイントタイプです。
  - プライベートエンドポイント: VPC 内から AWS PrivateLink でのみアクセスできるエンドポイントです。

- Amazon Kinesis Data Streams におけるシャード:

  - 基本的なスケーリング単位です。
  - 一つのシャードは、毎秒 1MB のデータ読み取り容量（最大 2,000 レコード/秒）と、毎秒 1MB のデータ書き込み容量（最大 1,000 レコード/秒）を提供します。
  - つまり、Kinesis Data Streams のパフォーマンス（データ入出力能力）は、シャードの数に直接的に関連します。
  - データはパーティションキーを基にシャードに分散され、一つのシャードには一つのパーティションキーが対応します。
  - このシャードの数を増やすと、データをより高速に書き込んだり読み取ったりすることができますが、コストも増加します。したがって、シャードの数を適切に管理することは、パフォーマンスとコストをバランス良く管理するために重要です。

- NLB: UDP トラフィックをサポート。
- ネットワーク ACL: 特定プロトコル以外のすべてのトラフィックを deny する機能を提供する。

- ![Screenshot 2022-11-21 at 8 01 15](https://user-images.githubusercontent.com/61643054/202931330-e8ef58b8-720d-40e7-bac7-f3bd5ed3c003.png)
- 基本的には AWS Shield Standard/AWS Shied Advanced/AWS WAF の３対策
  - AWS Shield Standard：Route 53 または CloudFront で使用する。無料。L3/L4 の防御。managed 分散サービス妨害(DDoS)に対する保護サービス。
  - AWS Shield Advanced：Route 53、CloudFront、ELB、EC2、AWS Global Accelerator で使用する。有料。L7、ネットワーク ACL を使った防御。
  - AWS WAF：CloudFront、ALB、APIGateway で使用。有料。IP アドレス、HTTP、クエリ文字列でのアクセス制限に加え、SQL インジェクション、クロスサイトスクリプティングにも有効。
- Amazon Intrusion Detection System(IDS): 侵入検知システム。悪意のあるアクティビティ、ポリシー違反、またはシステムの侵入または侵害を試みるユーザーからのネットワーク & システム攻撃を検出したときにアラートを送信します。
- Amazon Intrusion Prevention System(IPS): ネットワークトラフィックを監視および分析し、悪意のあるパターンや潜在的に有害なパケットを検出し、脆弱性の悪用を防止するアプライアンスです。SQL インジェクション、クロスサイトスクリプティング（XSS）、DDoS 攻撃への対応としては WAF による対応が優先されます。

## 53.

- CodePippeline:

  - コードの変更が毎回自動的に構築、テストされ、本番環境へのリリースのために準備されるリリースサービス。
  - AWS CloudFormation テンプレートへの変更を自動的に構築して、テストしてから本番環境スタックに構築させることができる。

- カナリア デプロイ: すでにデプロイされているバージョンと新しいバージョンの間でトラフィックを分割し、ユーザーのサブセットに展開して完全にロールアウトするアプリケーションの段階的なロールアウトです。
- Lambda の Version と Alias:

  - AWS Lambda では Publish すると固有の Version 番号が割り当てられる。
  - Version には任意の名前の Alias をつけることが可能で、Alias に関連付ける Version を変更することで、Alias を指定して Function を呼び出しているユーザが利用する Version を変更することができる。
  - Alias には Additional version というオプションが存在し、主として指定した Version とは異なる Version とその呼び出し割合を指定することができる。
  - Additional version の有無や呼び出し割合は任意のタイミングで変更ができ、新しい Version の呼び出し割合を徐々に増やしていくカナリアリリースが可能である。
  - ![Screenshot 2023-07-22 at 9 30 59](https://github.com/yoshikikasama/network-and-server/assets/61643054/ca783de8-a0bf-4c3a-b08e-c593837d725c)

- IAM の principal: AWS リソースに対するアクションまたはオペレーションをリクエストできる人間の ID またはワークロードです。
- ![Screenshot 2023-07-22 at 10 28 14](https://github.com/yoshikikasama/network-and-server/assets/61643054/00a48292-14c5-42d1-b28f-11bdc618d923)

## 54.

- DynamoDB TTL:

  - コストに影響を与えることなく項目を有効期限切れにするのに役立つ。
  - 項目ごとの timestamp を定義して、項目が不要になるタイミングを特定できる。
  - 指定された timestamp の日付と時刻の直後に DynamoDB は書き込みスループットを消費することなく、table から項目を削除する。

- Route53 のルーティングポリシー: DNS の応答をカスタマイズすることでクライアントからのトラフィックを適したリソースへルーティングする機能。

  - シンプルルーティング: 1 つのリソースに複数の IP アドレスを設定可能。
  - 加重ルーティングポリシー: ドメインに対して複数のリソースを関連付けることができ、割合を決めることができる。
  - フェイルオーバールーティングポリシー: Route53 のヘルスチェックによりリソースが正常なほうへトラフィックをルーティング。
  - レイテンシールーティングポリシー: ネットワークレイテンシーが最も低い AWS リージョンに基づいてリクエストをルーティングできる。
  - 位置情報ルーティングポリシー: DNS リクエストを送信したユーザーの地理的な場所に基づいて名前解決の結果を変えること。
  - 地理的近接性ルーティングポリシー: クライアントだけでなく AWS リソース側の位置情報を考慮してルーティングすることが可能。

- 共有 Transit Gateway:
  - 集中型インターフェイスを介して出カトラフィックを制御します。
  - 一元化するために、ネットワークサービスアカウントに出力 VPC を作成し、Transit Gateway を利用してこの VPC にあるスポーク VPC からのすべての出力トラフィックをルーティングします。Transit Gateway はロードバランサーではなく、2 つの AZ のインスタンス間でトラフィックを均等に分散しません。Transit Gateway を通過するトラフィックは、可能であれば AZ 内に留まります。単一の EC2 インスタンスの帯域幅機能によって制限されます。使用量が増えるにつれて、この EC2 インスタンスを垂直方向にスケーリングできます。出力トラフィック検査に選択したベンダーが障害検出の自動化をサポートしていない場合、または水平スケーリングが必要な場合は、別の設計を使用できます。この設計では、出力 VPC のトランジットゲートウェイに VPC アタッチメントを作成しません。代わりに、IPsec VPN アタッチメントを作成し BGP を利用してルートを交換するトランジットゲートウェイから EC2 インスタンスへの IPsecVPN を作成します。
  - 利点:BGP によって処理されるトラフィックの障害検出と再ルーティング。VPC サブネットルートテーブルの自動化は必要ありません。BGP ECMP を使用して、複数の EC2 インスタンス間でトラフィックの負荷を分散できます。水平スケーリングが可能です。
  - ![Screenshot 2023-07-22 at 15 45 25](https://github.com/yoshikikasama/network-and-server/assets/61643054/f60aa1bb-1805-4c36-baf1-a7a90df3fe9b)

## 55.

- Amazon Aurora Global Database: リージョン間でデータをレプリケートすることができるが、マルチマスター設定をサポートしていない。

  - マルチマスター設定：複数の Writer インスタンスを実行することができる機能。

- AWS IoT Core のサービス: IoT デバイスを AWS クラウドに接続するサービスを提供します。これにより、他のクラウドサービスやアプリケーションがコネクテッドデバイスとインタラクションできるようになります。
  - AWS IoT ルールアクション(Dynamo DB): DynamoDB アクションは MQTT メッセージの全てまたは一部を Amazon DynamoDB table に書き込む。

## 56.

- すべての AWS アカウントの集中型のログ記録アーキテクチャ:

  - Amazon CloudWatch アカウントのロググループにデータを送信するように CloudTrail および VPC フローログを設定します。各 AWS アカウントに CloudWatch サブスクリプションフィルターを設定し、ロギングアカウント内の Amazon Kinesis Data Firehose にデータを送信します。ロギングアカウントで Kinesis Data Firehose から AmazonOpenSearch にデータをロードします。

- AWS Cloud Adoption Readiness Tool(CART): 組織のクラウド導入を支援するツール。現在の環境/データセンターを評価し、推奨事項を作成することでクラウドへの移行の準備に役立ちます。

## 57.

- AWS SSO: Web ブラウザのみを介したビジネスアプリケーションへの SSO をサポートし、モバイルアプリをサポートしていない。
- AWS Organizations: 複数の AWS アカウントを効率的に管理・統制するためのサービス。

  - 新しい AWS アカウントを作成しリソースを割り当てる
  - AWS アカウントをグループ化して整理
  - AWS アカウントまたはグループに統一されたポリシーを適用
  - すべての AWS アカウントに単一の支払い方法を利用することで請求を簡素化
  - OU(Organization Unit): 組織単位。組織内にある複数 AWS アカウントのグループ。
  - SCP(Service Control Policy): AWS アカウントまたはグループに統一されたポリシーを適用するための機能です。
    - 「SCP と IAM で明示的に許可され」なおかつ「いずれでも明示的に拒否されていない」場合に権限を有していると評価されます。
    - 「ざっくりとした」制限を SCP で実施し、細かい制御を IAM で実施する、というアプローチが適切かと思います。
  - 組織の証跡: OU を作成した場合に、その OU 内の全 AWS アカウントの全イベントを記録する証跡を作成できる。
  - マスターアカウント(管理アカウント): 組織の作成に使用する AWS アカウントのことです。管理アカウントでは、組織内の他のアカウントの作成、他のアカウントが組織に参加するための招待の送信と管理、組織からのアカウントの削除を行うことができます。管理用ルート、組織単位 (OU)、組織内のアカウントといったエンティティにポリシーをアタッチすることもできます。管理アカウントは、組織の最終的な所有者であり、セキュリティ、インフラストラクチャ、および財務ポリシーについての最終的な管理権限を有しています。このアカウントには支払者アカウントの役割もあり、組織内のアカウントによって発生した料金すべてに対する支払いの責任を負います。組織の管理アカウントを変更することはできません。
  - 管理用ルート: 管理アカウントに含まれており、AWS アカウントを整理するための開始点です。管理用ルートは組織の階層内で一番上のコンテナです。このルートの下で、アカウントを論理的にグループ化するために OU を作成し、その OU をビジネスニーズに最適な階層に整理できます。
  - 利用可能な機能セット:
    - 全ての機能: 一括請求機能も含む、高度なアカウント管理機能。
    - 一括請求機能: OU 内のアカウント管理を一元化する基本的な機能。
  - ![Screenshot 2022-11-23 at 9 33 50](https://user-images.githubusercontent.com/61643054/203450104-8b13678e-2e1a-4ec7-96ff-e481e872cebd.png)
  - ![Screenshot 2022-11-23 at 9 36 24](https://user-images.githubusercontent.com/61643054/203450125-6d282f87-1410-4c32-9d0c-98d34389fbc7.png)

## 58.

- AWS Secret Manager: DB の認証情報を生成および保存するために使用できる。AWS Lambda 関数を使ってパスワードのローテーションを行い、AWS Secret Manager の RotationShedule リソースを使用して、90 日ごとに DB のパスワードをローテーションさせることができる。

## 59.

- タグエディタ: 既存のリソースのタグを修正でき、SCP を使用すると組織全体で必要なタグを持たない新しいリソースの作成を制限することができる。

## 60.

- 別の AWS アカウントの AWS Identity and Access Management (IAM) ユーザーが、自分の Amazon Simple Storage Service (Amazon S3) バケットへオブジェクトをアップロードしました。そのオブジェクトにアクセスしようとすると、403 アクセス拒否エラーが表示されます。どうすれば解決できますか:

  - デフォルトのオブジェクト所有権が設定された既存の Amazon S3 バケットの場合、オブジェクト所有者はオブジェクトをバケットにアップロードした AWS アカウントになります。これらの既存のバケットでは、オブジェクト所有者はオブジェクトに (アクセスコントロールリストを添付して) アクセス許可を明確に付与する必要がありました。これをしないと、バケット所有者はオブジェクトにアクセスできなくなります。

- クラスタープレイスメントグループ: 単一の AZ 内のインスタンスを論理的にグループ化したもの。同じ region 内の複数のピア VPC にまたがることができる。
- Elastic Fabric Adapter(EFA): ハイパフォーマンスコンピューティング(HPC)と機械学習アプリケーションを高速化するために EC2 インスタンスにアタッチできるネットワークデバイス。
- Amazon FSx For Lustre:

  - 高パフォーマンスの Lustre ファイルシステムを提供し、大規模なデータセットを処理するために必要なスループットを提供する。
  - 世界最速のコンピュータ向けに設計された広く使用されているファイルシステム。
  - FSx For Lustre は S3 と統合されている。

- VPC エンドポイントポリシー: VPC エンドポイントにアタッチできるリソースベースのポリシーで、どの AWS プリンシパルがエンドポイントを使用して AWS のサービス にアクセスするかを制御します。

- DynamoDB Accelerator(DAX): アプリケーションに高速なメモリ内パフォーマンスを提供するキャッシングサービス。

- スロットル: 一定時間内に送信できるリクエスト数を制限するプロセスのことです。
