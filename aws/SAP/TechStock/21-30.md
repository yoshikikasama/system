# Techstock

## 21.

- IP ユニキャスト:

  - ネットワーク上の特定の宛先にデータを送信する方法です。送信元は特定の宛先の IP アドレスを持つデバイスにデータを送信します。この方法では、データは送信元から宛先のデバイスに直接的に届けられます。
  - 一対一の通信を実現するために使用されます。つまり、送信元が 1 つのデバイスに対してデータを送信し、そのデバイスだけがデータを受信します。他のデバイスは、そのデータの転送に関与しません。
  - AWS の仮想ネットワーキング環境での通信方法であり、データを 1 対 1 の通信で送信するためのもの

- IP マルチキャスト: ネットワーク上でデータを一度に複数の宛先に送信するための通信方法です。これにより、複数のサーバーが同じデータを受信できるため、効率的な共有セッションの状態管理が可能になります。IP マルチキャストは、特定の IP アドレス範囲に属する複数のデバイスにデータをブロードキャストするために使用されます。

- IP マルチキャストに依存する共有セッションの状態: 複数のサーバーが IP マルチキャストを使用してセッションの状態情報を共有することを意味します。一般的には、セッションの状態はクラスター内の他のサーバーと同期され、各サーバーが同じ状態を把握できるようになります。これにより、ユーザーが異なるサーバーにアクセスしても、同じセッション状態を維持できます。

- ディスカバリー: 新しいサーバーがクラスターに参加したり、既存のサーバーがクラスターから離脱したりするときに、自動的にそれを検出するための手段を提供します。
- ディスカバリー用のクラスター化メカニズム: オンプレミス環境で使用される一連の技術やプロトコルのことを指します。このメカニズムは、複数のアプリケーションサーバーがクラスターを形成し、共有リソースや共有セッションの管理を可能にします。

- Amazon RDS は書き込みを処理するために水平方向にスケーリングできない。

## 22.

- DynamoDB:

  - Fine Grained Access Control: DynamoDB テーブルの所有者がテーブル内のデータに対して詳細なコントロールを行うための機能です。具体的には、テーブル所有者は誰（呼び出し元）がテーブルのどの項目や属性にアクセスでき、どのようなアクション（読み込み/書き込み）を実行できるかを指定できます。FGAC は、AWS Identity and Access Management（IAM）と組み合わせて使用されます。セキュリティ認証情報および対応するアクセス権限の管理は、IAM で行います。
    - FGAC を利用する場合には、アプリケーションはセキュリティトークンをリクエストします。このトークンは、特定の DynamoDB テーブル内の特定の項目のみへのアクセスをアプリケーションに認可するものです。
    - このトークンを使用して、エンドユーザーアプリケーションエージェントは DynamoDB に対して直接リクエストを発行します。このリクエストが受信されると、リクエストの認証情報が DynamoDB によって検証されます。リクエストの認証には IAM が使用され、そのユーザーにどの操作を許可するかが決定します。ユーザーのリクエストが許可されない場合は、データへのアクセスが FGAC によって阻止されます。
    - FGAC が効果を発揮するのは、DynamoDB テーブルを使用して情報をトラッキングするアプリケーションにおいて、エンドユーザー（またはエンドユーザーの代理となるアプリケーションクライアント） がテーブルの読み取りや変更を、中間層サービスなしで直接行う必要がある場合です。

- MapReduce: Google のバックエンドで利用されている並列計算システムで、大規模なデータを分散処理するためのプログラミングモデルです。
- Hadoop: 大規模データの分散処理を行うための Java フレームワークで、MapReduce と HDFS で構成されています。
- HDFS(Hadoop Distributed File System): 複数のサーバーにファイルを分割して保持することで、巨大なファイルも扱える分散ファイルシステム。
- Hive:Hadoop 上のデータを SQL に似た命令で操作できるツールです。

- Amazon EMR: Apache Spark, Presto, Trino, Hadoop, Hive, Hbase などのオープンソースフレームワークを使用したビッグデータ分析
  - 莫大な量のデータを処理することができるようにする Amazon のウェブサービスです。これは後述する Hadoop を利用して実現しており、Hadoop は、EC2 上に構築されます。EC2 を立てて Hadoop クラスタ構築をしなくても、EMR を使えばそこを全部 AWS がやってくれるわけですね。
  - Hadoop クラスターを実行するために使用できるサービスです。 Hadoop クラスターとはサーバーセットであり、このサーバーセットは連動して、サーバー間で処理およびデータを分散することにより計算タスクを実行する。 タスクの内容は、データの分析、データの格納、またはデータの移動と変換などが考えられる。 また、起動するとき、EC2 によって提供される仮想サーバーでクラスターを実行する。
  - アプリケーション: OSS フレームワークと version
    - job: アプリケーション上で複数のジョブを実行
    - Worker: ワークロードを実行するために内部的に利用
  - マスターノード:
    - クラスターを管理し、通常は分散アプリケーションのマスターコンポーネントを実行する。
    - 例えば、アプリケーションのリソースを管理するための YARN ResourceManager サービス、および HDFS NameNode サービスを実行します。
    - マスターノードは一つのみ。
  - コアノード:
    - マスターノードによって管理。
    - データノードデーモンを実行して HDFS の一部としてデータストレージを調整する。
    - タスクトラッカーデーモンを実行し、インストールされているアプリケーションが要求するデータ上で、その他の並列計算タスクを実行する。
    - 例えば、YARN NodeManager デーモン、Hadoop MapReduce タスク、および Spark 実行プログラムを実行する。
    - マスターノードのように最低 1 つのコアノードが必要
  - タスクノード:
    - オプション。
    - Hadoop MapReduce タスクや Spark 実行プログラムなど、データに対して並行計算タスクを実行するための能力を追加するために使用できる。
    - オンデマンドインスタンスとスポットインスタンスなど、異なる EC2 インスタンスタイプおよび価格設定オプションを組み合わせることができる。
    - スポットインスタンスはタスクノードの実行に使用されることが多いため、Amazon EMR には、タスクノードが終了しても実行中のジョブが失敗しないように YARN ジョブをスケジュールするための機能がデフォルトで備えられています。Amazon EMR は、アプリケーションマスタープロセスをコアノードでのみ実行できるようにすることで、これを実現しています。アプリケーションマスタープロセスは実行中のジョブを制御し、ジョブが有効である間は存続する必要があります。

## 24.

- ファットクライアント: 従来からの PC に代表されるようにクライアント側であらゆる処理が実行できるように記憶媒体やアプリケーションドフとなどの環境を全て実装したコンピュータのこと。
- Route53 のプライベート DNS レコード: オンプレミスでの使用には拡張できず、発信元のリクエストが VPC 内から行われた場合にのみ機能します。

  - この問題を解決するためには、オンプレミス環境に対して適切な DNS の設定を行う必要があります。オンプレミスの VMWare インスタンスには、Route 53 のプライベート DNS サーバーを指す適切な設定が必要です。これにより、オンプレミス環境からの DNS リクエストが適切に解決され、EC2 インスタンスにアクセスできるようになります。
    - VMWare インスタンスの DNS 設定ファイル /etc/resolv.conf を編集します。
    - /etc/resolv.conf ファイルを開き、DNS サーバーの IP アドレスを追加します。この IP アドレスは VPC 内で機能する Route 53 のプライベート DNS サーバーの IP アドレスです。
    - 例えば、Route 53 のプライベート DNS サーバーの IP アドレスが 172.31.0.2 である場合、以下のように設定します。
      - nameserver 172.31.0.2
    - 保存して /etc/resolv.conf ファイルを閉じます。
    - オンプレミスの VMWare インスタンスの DNS 設定が更新されました。これにより、VMWare インスタンスからの DNS リクエストは Route 53 のプライベート DNS サーバーに送信され、プライベート A レコードが解決されるようになります。
  - Route53 Resolver のインバウンドエンドポイントを使用することで、オンプレミスから VPC 内の DNS 解決を可能にすることができます。
    - 以下の手順に従って設定を行ってください。AWS Management Console にサインインし、Route 53 Resolver を開きます。
    - 「アクティビティハブ」セクションで、「インバウンドエンドポイントの作成」をクリックします。
    - インバウンドエンドポイントの作成画面で、以下の設定を行います:
      - ドメイン名: 内部 DNS のドメイン名を入力します（例: example.com）。
    - IP アドレス範囲: VPC 内の DNS サーバーの IP アドレス範囲を入力します（例: 10.0.2.0/24）。
    - 「インバウンドエンドポイントの作成」をクリックしてインバウンドエンドポイントを作成します。
    - インバウンドエンドポイントの作成が完了したら、オンプレミスネットワークの DNS 設定を変更します。オンプレミスの DNS サーバーの設定または DHCP サーバーの設定を変更し、インバウンドエンドポイントの IP アドレスを DNS サーバーとして指定します。
      - https://qiita.com/mksamba/items/b16e99170e666b68f194

- DDoS 攻撃対策:
  - CloudFront を作成
  - ELB をオリジンとして設定
  - AWS Lamnda 関数作成し、CloudFront ログから不正なリクエストを識別、AWS WAF ルールを更新して悪意のあるトラフィックのソース IP アドレスをブロック。
- AWS WAF: 定義する条件に基づきウェブリクエストを許可、ブロック、または監視 (カウント) するルールを設定し、ウェブアプリケーションを攻撃から保護するのを助ける Web アプリケーションファイアウォールです。それらの条件には IP アドレス、HTTP ヘッダー、HTTP 本文、URI 文字列、SQL インジェクション、およびクロスサイトスクリプトが含まれます。
- AWS Shield:
  - 検知：通常のトラフィックパターンと比較して異常に高いトラフィックの増加、同時接続数の急増、異常な IP アドレスのパターン
  - 防御策:
    - 攻撃トラフィックを特定の規則に基づいて自動的にフィルタリングしブロック
    - 攻撃トラフィックを分散させることで負荷を軽減
- AWS Shield Advanced:
  - 機械学習による攻撃検出と自動化された防御

## 25.

- A/B テスト: 特定の要素を変更した A パターン、B パターンを作成し、ランダムにユーザーに表示し、それぞれの成果を比較することで、より高い成果を得られるパターンを見つけること。

- スナップショットから作成された EBS ボリュームの事前ウォームアップ:
  - アクセスする前に、ストレージブロックが Amazon S3 からプルダウンされてボリュームに書き込まれる必要がある。

## 26.

-AWS CloudHSM:

- 物理デバイス制御とキーへのアクセスを持たないアプリケーションで秘密鍵を強力に保護する。
- ウェブサーバーでは、パブリック/プライベートのキーペアと SSL/TLS パブリックキー証明書を使用して、各クライアントとの HTTPS セッションを確立します。このプロセスは、ウェブサーバーにとって多くの計算を伴いますが、AWS CloudHSM クラスターの HSM に対するこの計算の一部をオフロードすることができます。このプロセスは、SSL アクセラレーションと呼ばれることもあります。オフロードすることで、ウェブサーバーの計算負荷が軽減され、サーバーのプライベートキーを HSM に保存することでセキュリティが強化されます。

- オフロード（Offloading）: 特定の処理や負荷をネットワークや他のシステムに移すことを指します。このアプローチにより、主要なシステムやアプリケーションから負荷を軽減することができます。

- Auto Scaling ヘルスチェック:
  - EC2 ステータスチェック(デフォルト): インスタンスの状態が runnning 以外の場合、もしくはステータス impaired の場合に異常とみなされます。
  - ELB: ターゲットグループのヘルスチェックで unhealthy となったインスタンスを異常とみなします。
  - カスタムヘルスチェック: ユーザーが独自で用意した監視をヘルスチェックとして使用し、unhealthy となったインスタンスを異常とみなします。
- ELB ヘルスチェック:
  - ターゲットに対して設定したプロトコルでアクセスを行い正常にアクセスできるかをテストする操作。合格したインスタンスのみにリクエストがルーティングされる。
  - ELB から見た EC2 の IP アドレス
- Route53 のヘルスチェック: システムのエンドポイントに対するヘルスチェック。複数のリージョンにあるシステムに対して可能。

## 27.

- SAML（Security Assertion Markup Language）: セキュリティ認証および認可のための XML ベースのオープンスタンダードです。SAML は、アイデンティティプロバイダ（IdP）とサービスプロバイダ（SP）の間で認証情報を交換するために使用されます。具体的には、ユーザーがアイデンティティプロバイダで認証され、認証トークン（SAML トークン）が生成されます。その後、ユーザーは SAML トークンを使用してサービスプロバイダにアクセスし、認証を行います。SAML はシングルサインオン（SSO）の実現やセキュアな情報共有に広く利用されています。

- SAML の処理の一般的な流れは以下のようになります：

  - ユーザーがサービスプロバイダ（SP）のウェブアプリケーションにアクセスします。
  - サービスプロバイダは、ユーザーの認証情報（ユーザー名やパスワードなど）を要求します。
  - ユーザーが認証情報を入力すると、サービスプロバイダはアイデンティティプロバイダ（IdP）に対して認証リクエストを送信します。
  - アイデンティティプロバイダは、ユーザーの認証情報を検証し、認証が成功した場合、SAML レスポンスを生成します。
  - アイデンティティプロバイダは SAML レスポンスをサービスプロバイダに返します。
  - サービスプロバイダは、SAML レスポンスを検証し、ユーザーの認証が正当であることを確認します。
  - サービスプロバイダは、ユーザーに対してセッションを開始し、アクセスを許可します。
  - ユーザーは、サービスプロバイダを介してアプリケーションやリソースにアクセスすることができます。
  - この流れによって、ユーザーはアイデンティティプロバイダを通じて一度認証され、その認証情報がサービスプロバイダによって信頼されることが保証されます。SAML は、セキュアなシングルサインオン（SSO）を実現するためのプロトコルとして広く使用されています。

- STS（Security Token Service）は、AWS の一時的なセキュリティ認証情報（トークン）を提供するサービスです。STS トークンは、一時的な認証情報として生成され、特定のアクセス権限を持つ一時的な認証情報を他のユーザーやサービスに渡すことができます。これにより、信頼できるエンドユーザーに対して限定された権限を付与することができます。

- SAML と STS トークンの違いは、主に以下の点です：

  - SAML は、アイデンティティプロバイダ（IdP）とサービスプロバイダ（SP）間の認証情報の交換に使用されるオープンスタンダードです。一方、STS トークンは AWS 内で一時的なセキュリティ認証情報を提供するためのサービスです。
  - SAML は、アプリケーションやシステム間でのシングルサインオン（SSO）を実現するために使用されます。一方、STS トークンは、AWS のリソースへの一時的なアクセスを制御するために使用されます。
  - SAML は XML ベースの形式で認証情報を交換します。一方、STS トークンは JSON 形式のトークンとして提供されます。
  - SAML は、非 AWS 環境やアプリケーションにも適用可能です。一方、STS トークンは AWS 内のリソースへのアクセスに使用されます。
  - 要するに、SAML はアイデンティティプロバイダとサービスプロバイダ間の認証情報の交換に使用される一般的なプロトコルであり、STS トークンは AWS 内での一時的な認証情報の提供に使用される AWS 固有のサービスです。

- AMI ID: リージョンが異なれば AMI ID も異なる。

  - https://blog.serverworks.co.jp/automate-latest-ami-ec2

- Fn::GetAZs: 指定したリージョンのアベイラビリティーゾーンをアルファベット順にリストした配列を返します。CFn で異なる region にデプロイする際は、AZ 名が region ごとに異なるため、この記載を行う。

- AWS OpsWorks:

  - Chef や Puppet のマネージド型インスタンスを利用できるようになる構成管理サービスです。Chef や Puppet は、コードを使用してサーバーの構成を自動化できるようにするためのオートメーションプラットフォームです。
  - CloudFormation はほぼすべてのリソースを作成可能
  - OpsWorks はアプリケーション周りのリソース作成に限られる

- セキュリティグループ:
  - 適用単位: サブネット単位(EC2, RDS ごとに適用される)
  - 制御する種類: 許可のみを In/Out で指定
  - 戻りの通信の取り扱い: ステートフル(インバウンドのみ設定すればアウトバウンドも許可される)
  - デフォルトでは同じセキュリティグループ内通信のみ許可
  - 全てのルールを適用
  - 制御内容の指定方法: プロトコル、PORT,CIDR, セキュリティグループ
  - インスタンス単位で設定するファイアウォール機能
- ネットワーク ACL:

  - 適用単位: インスタンス単位(サブネット内の全 AWS サービスに適用)
  - 制御する種類: 許可/拒否を In/Out で指定
  - 戻りの通信の取り扱い: ステートレス(インバウンド設定だけではアウトバウンドは許可されない)
  - デフォルトでは全ての通信を許可する設定
  - 番号の順序通りに適用
  - 制御内容の指定方法: PORT,CIDR
  - サブネット単位で全インスタンスに適用するファイアウォール機能

- SR-IOV: シングルルート I/O 仮想化を使用して、サポートされるインスタンスタイプにおける高性能ネットワーキング機能が提供される。

## 28.

- ![Screenshot 2023-06-23 at 7 44 11](https://github.com/yoshikikasama/network-and-server/assets/61643054/6befa82f-92a9-4d3a-8a69-6740afed7cda)

  - AWS Direct Connect ゲートウェイを使用すると、プライベート仮想インターフェイスを介して、AWS Direct Connect 接続を、同じリージョンまたは異なるリージョンに配置されたアカウントの 1 つ以上の VPC に接続できます。
    - Direct Connect Gateway を VPC の仮想プライベートゲートウェイに関連付けます。
    - 次に、Direct Connect ゲートウェイへの AWS Direct Connect 接続のプライベート仮想インターフェイスを作成します。
    - 複数のプライベート仮想インターフェイスを、Direct Connect ゲートウェイにアタッチできます。

- AWS Direct Connect:
  - AWS Direct Connect の回復性に関する推奨事項: https://aws.amazon.com/jp/directconnect/resiliency-recommendation/
  - ![Screenshot 2023-06-23 at 8 26 06](https://github.com/yoshikikasama/network-and-server/assets/61643054/dcaf09b5-0ba7-415d-8775-0de32c92e8fa)
  - ![Screenshot 2023-06-23 at 8 26 17](https://github.com/yoshikikasama/network-and-server/assets/61643054/cd453f13-7828-4907-be5b-cbd4fd6dd216)
  - Connection 接続 = 物理接続(1G or 10 G)
  - 仮想インターフェイス(Virtual Interface(VIF)):
    - Connection を通して AWS リソースにアクセスするための r んりインターフェイス。
    - AWS とお客様ルータの間で BGP ピアを確立し経路交換をするために必要。
    - VLAN ID を持つ。
  - Private VIF: VPC へ Private IP を介した接続を提供
  - Public VIF: AWS の全リージョンへ Public IP を介した接続を提供
  - Transit VIF: Transit Gateway 用の Direct Connect Gateway へ接続を提供。
  - 
