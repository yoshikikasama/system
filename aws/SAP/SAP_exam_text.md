# SAP 試験テキスト

- IAM について:

  - https://qiita.com/c60evaporator/items/0121399880625cc1de51
  - 管理ポリシー → スタンドアロン（ユーザーやロールとは別個に作成する）ポリシー
    - AWS 管理ポリシー → AWS がデフォルトで準備している IAM 管理ポリシー
    - カスタマー管理ポリシー → 利用者が独自に作成、管理する管理ポリシー
  - インラインポリシー → 1 つのアイデンティティ（ユーザー、ロール、グループ）に埋め込まれたポリシー
  - AWS 管理ポリシーを使用 → 必要に応じてカスタマー管理ポリシーを追加の順で選択・運用する事が推奨されています (インラインポリシーは推奨度低)
  - policy の記述:
    - Version → ポリシーの記述言語のバージョン（基本的には 2012/10/17 で固定）
    - id → ポリシーの識別子（オプションのため、上記 AmazonS3ReadOnlyAccess では記述なし）
    - Statement → ポリシーの詳細を記述するフィールド
    - Statement フィールドの下には、以下のフィールドに具体的な条件を記述する必要があります。
    - Effect → アクセス権限の種類（基本的には"Allow"(許可)か"Deny"(拒否)）
    - Action → 許可または拒否するアクション（アスタリスク\*は以下の全アクションが対象となる）
    - Resource → アクションの設定対象となるリソース一覧（S3 の場合、バケット名等を指定）
    - Sid → 複数 Statement が存在する場合の識別子（上記 AmazonS3ReadOnlyAccess では記述なし）
    - Condition → ポリシー適用対象を絞るための追加条件（上記 AmazonS3ReadOnlyAccess では記述なし）
  - リソースベースのポリシー: 例えば S3 のバケットには、独自のリソースベースのポリシー(バケットポリシー)を設定する事ができます。これにより、アクセスされる側であるバケットへのアクセス制御を実現する事ができます。リソースベースのポリシーは使用できるサービス（S3、SQS、VPC 等）が限られていますが、特定のリソース（例：S3 内の特定のバケットに保存された機密データ）のセキュリティを選択的に高めたい場合に役立つでしょう。
  - 信頼ポリシー: あるロールが持っている権限を他のプリンシパル（ユーザー、グループ、ロール）に移譲することができます
  - PassRole: Role を移譲するポリシー

- VPC:

  - https://qiita.com/c60evaporator/items/2f24d4796202e8b06a77
  - サブネット: ネットワーク部が等しい IP アドレス範囲のこと。サブネットを表すアドレスをネットワークアドレスと呼びます
  - ルーティング: サブネットの結節点において他のサブネットとの通信経路を決定する制御を指します。自サブネット以外との通信にはルーティングが必要となるため、複数のサブネットが存在するネットワークにおいて必須の技術と言えます。
  - ルーティングテーブル: ルーティングのルールを定めるテーブル。ルールの決め方には、IP アドレスに基づいて毎回同じ経路が選択される「静的ルーティング」と、動的に経路が決定される「動的ルーティング」が存在しますが、VPC では基本的に静的ルーティングを使用します (VPN やトランジットゲートウェイ使用時は BGP による動的ルーティングでオンプレネットワークと連携することもできます)
  - VPC においては、「ルートテーブル」というサービスを使用する事でサブネット (後述)ごとにルーティングを制御できます。
  - DHCP(Dynamic Host Configuration Protocol): ホストにネットワーク関係の情報を渡すためのプロトコルです。一般的に、ホストにプライベート IP アドレスを動的に割り振る際に使用されますが、それ以外にも DNS サーバの IP アドレスやデフォルトゲートウェイ(ルーター)の IP アドレス等の情報がホストに渡されます。VPC においても、後述の Elastic IP を使用しない限りはこの DHCP 機能が働き、VPC 内部のインスタンスの IP アドレスは動的に割り振られます (再起動すると IP アドレスが変わる)
  - 外向き：内部ネットワーク(VPC 等)からインターネット方向への通信
  - 外向き：内部ネットワーク(VPC 等)からインターネット方向への通信
  - パブリックサブネット:
    - インターネットと直接通信できるサブネット。
    - インターネットゲートウェイにルーティングされるサブネット。
    - パブリックサブネットは外部から(へ)のアクセスが必要な Web サーバやプロキシサーバを設置する。
  - プライベートサブネット:
    - インターネットと直接通信できないサブネット
    - インターネットとの通信が必要ないインスタンスを設置する
  - メインルートテーブル：VPC ごとに自動で作成されるルートテーブル(編集も可能)。サブネットルートテーブルが設定されていないサブネットに適用される
  - サブネットルートテーブル：ユーザが自分で作成し、サブネットと紐づけるルートテーブル
  - インターネットゲートウェイと NAT ゲートウェイ:
    - ![Screenshot 2023-07-02 at 8 28 32](https://github.com/yoshikikasama/network-and-server/assets/61643054/d482496d-ca4f-491f-913c-32b91078bfbe)
    - インターネットゲートウェイ: パブリックサブネットを作成する際に必ず必要となるサービスであり、インターネットとの外向き、内向き双方向の通信を許可します。
    - NAT ゲートウェイ: プライベートサブネットから外向きの通信のみを許可する(内向きは許可しない)サービス。
  - Security Group: サーバ単位あるいはサービス単位といった単位のフィルタ
  - Network ACL: 「特定の IP アドレスからは一切通信をドロップする」といったネットワーク単位での大きなフィルタ
  - ![Screenshot 2023-07-02 at 9 15 21](https://github.com/yoshikikasama/network-and-server/assets/61643054/498cb239-c26a-40ad-be91-6cd79aa8cca6)
  - <img width="760" alt="Screenshot 2023-07-03 at 22 10 52" src="https://github.com/yoshikikasama/network-and-server/assets/61643054/efb25a85-dae8-4fd4-9f4d-e0e23d1c2a48">
  - Egress Only インターネットゲートウェイ: IPv6 専用のインターネットゲートウェイで、外向きの通信のみを許可する(内向きは許可しない)という意味
  - ネットワークファイアウォール: ホワイトリスト・ブラックリスト両者、かつステートレス・ステートフル両者を設定可能で、柔軟なアクセス制御を実現できます。注意点として、ネットワークファイアウォール使用時はルートテーブルを編集して、インターネットとの通信が必ずファイアウォールエンドポイントを経由するよう設定する必要があります。
  - AWS WAF:
    - Web アプリケーションの脆弱性を利用した攻撃から web アプリケーションを保護するサービス。
    - 複数のルールを組み合わせて使用
    - Application Load Balancer(ALB)、Amazon CloudFront、Amazon API Gateway、AWS AppSync にアタッチして使用。トラフィックの検査を開始するには、既存の ALB または CloudFront ディストリビューションでサービスを有効にする必要があります。
  - AWS Network Firewall:
    - VPC サブネットに配置して使用するマネージドサービス
    - ただの FW ではなくシグネチャベースの IDS/IPS としても使用可能
    - パケットのペイロードまで見て、フィルタリングを行う
    - ルールで評価した通信に対してアクションを選択可能
    - ![Screenshot 2023-07-08 at 19 37 11](https://github.com/yoshikikasama/network-and-server/assets/61643054/5120d839-78ae-4ee8-a4be-1f88026f4444)
    - ネットワークコスト:
      - AWS への受信（イン）は料金が発生しない
      - AWS からの送信（アウト）は料金が発生する
      - なんらかのゲートウェイを経由するとデータ転送量に応じた料金が発生する

- Amazon EC2:
  - ![Screenshot 2023-07-12 at 6 46 54](https://github.com/yoshikikasama/network-and-server/assets/61643054/a74721bc-d317-449a-8002-30aef0279c89)
  - AMI (OS): AMI (Amazon Machine Images)とは、インスタンス起動時に実行される OS イメージを表します。
  - インスタンスタイプ: サーバにおいて処理を実行する装置(CPU, メモリ等)を選択します。
    - t2.micro のような名称で表されます。名称の解釈として、t の部分がインスタンスの種類(ファミリー)、2 の部分が世代、micro の部分がサイズを表しており、ファミリーは用途と対応、世代とサイズは基本的に大きいほど高スペックとなります。
    - ![Screenshot 2023-07-12 at 6 49 57](https://github.com/yoshikikasama/network-and-server/assets/61643054/4cf03249-adbb-4141-8cc8-29be21c48376)

